# 迭代规划视图设计说明

## 用户需求确认

根据用户反馈：
> "MR拆解和依赖连线的数据，是在timeplan的时间节点下，为迭代规划视图中每个团队-模块-迭代构造的数据，用于这个视图的显示和操作"

## 当前实现问题

**现有IterationView** (`src/components/views/IterationView.tsx`):
- ❌ 按**时间范围**自动划分迭代（每14天一个迭代）
- ❌ 没有按团队/模块分组
- ❌ 没有显示MR之间的依赖关系
- ❌ 不适合展示OrionX的MR拆解数据

## 应该的实现方案

### 数据结构
OrionX v4数据包含：
- `attributes.module`: 模块名（如"E0架构"、"视觉感知"、"行为决策"）
- `attributes.productLine`: 产品线（如"电子架构"、"感知算法"、"规划决策"）
- MR之间的依赖关系（`relations`数组）

### 视图布局（推荐方案）

```
迭代规划视图
├── 【产品线：电子架构】
│   └── 【模块：E0架构】
│       ├── E0.1 域控架构方案设计 → E0.2 传感器配置
│       ├── E0.2 传感器配置 → E0.3 系统通信
│       └── E0.3 系统通信架构
│
├── 【产品线：感知算法】
│   └── 【模块：视觉感知】
│       ├── P1.1 图像预处理 → P1.2 目标检测
│       ├── P1.2 目标检测 → P1.3 多帧跟踪
│       ├── P1.3 多帧跟踪 → P1.4 语义理解
│       └── P1.4 环境语义理解
│
├── 【产品线：规划决策】
│   ├── 【模块：行为决策】
│   │   ├── PL1.1 决策状态机 → PL1.2 强化学习
│   │   ├── PL1.2 强化学习 → PL1.3 评估
│   │   └── PL1.3 决策评估验证
│   │
│   └── 【模块：路径规划】
│       ├── PL2.1 全局路径规划 → PL2.2 局部规划
│       └── PL2.2 局部路径规划
```

### 功能需求

1. **分组显示**
   - 一级分组：产品线（productLine）
   - 二级分组：模块（module）
   - MR列表：每个模块下的所有MR

2. **依赖关系可视化**
   - 在每个MR卡片上显示依赖箭头
   - 高亮显示依赖路径
   - 支持悬停查看依赖详情

3. **MR卡片信息**
   - MR名称和标签
   - 开始/结束日期
   - 负责人
   - 进度条
   - 依赖关系图标

4. **交互功能**
   - 点击MR查看详情
   - 拖拽调整MR顺序（可选）
   - 筛选模块/产品线
   - 搜索MR

## 实现建议

### 方案1：扩展现有IterationView
- 修改数据分组逻辑
- 添加module/productLine分组
- 添加依赖关系渲染

### 方案2：创建新的ModuleIterationView
- 保留原IterationView用于时间迭代
- 创建新组件专门用于模块迭代
- 在UnifiedTimelinePanelV2中添加新视图选项

## 优先级

**高优先级**：
1. 修复TableView导入问题（✅ 已完成）
2. 确认迭代视图需求
3. 设计并实现按模块分组的迭代视图
4. 添加依赖关系可视化

**中优先级**：
1. 添加MR拖拽功能
2. 完善筛选和搜索

**低优先级**：
1. 导出迭代规划数据
2. 迭代模板功能

## 下一步

等待用户确认：
1. 是否采用按模块/产品线分组的方案？
2. 是否需要修改现有IterationView还是创建新视图？
3. 依赖关系可视化的具体需求（箭头、连线、或其他形式）
