# TimePlan Craft Kit - 产品需求文档 (PRD)

**版本**: v1.0.0  
**日期**: 2026-02-09  
**状态**: ✅ 已实现  
**产品**: 智能时间线管理平台

---

## 📋 文档目录

1. [产品概述](#产品概述)
2. [目标用户](#目标用户)
3. [核心功能需求](#核心功能需求)
4. [非功能需求](#非功能需求)
5. [用户场景](#用户场景)
6. [功能优先级](#功能优先级)
7. [验收标准](#验收标准)

---

## 🎯 产品概述

### 产品名称
**TimePlan Craft Kit** - 智能时间线管理平台

### 产品定位
面向复杂项目管理的智能时间线管理平台，专为多团队协作和敏捷开发场景设计。

### 核心价值主张
1. **可视化项目管理** - 将复杂的项目计划转化为直观的甘特图视图
2. **多视角管理** - 提供甘特图、表格、模块规划等多种视图
3. **灵活的数据模型** - 基于 Schema 的扩展架构，适应不同业务场景
4. **高效协作** - 支持多团队、跨模块的协同工作
5. **智能依赖管理** - 自动识别和可视化任务依赖关系

### 业务目标
- 提升项目管理效率 30%+
- 减少沟通成本 40%+
- 提高项目可视化程度
- 支持100+并发任务编辑

---

## 👥 目标用户

### 主要用户角色

#### 1. 项目经理 (PM)
**需求**:
- 查看项目整体进度
- 跟踪关键里程碑
- 识别项目风险和瓶颈
- 生成项目报告

**使用频率**: 每天多次  
**技术水平**: 中等

#### 2. 团队负责人 (TL)
**需求**:
- 管理团队任务分配
- 协调资源
- 查看任务依赖关系
- 调整任务优先级

**使用频率**: 每天多次  
**技术水平**: 中等到高

#### 3. 产品经理 (PO)
**需求**:
- 规划产品版本
- 管理特性交付
- 查看模块规划
- 跟踪迭代进度

**使用频率**: 每周多次  
**技术水平**: 中等

#### 4. 开发人员
**需求**:
- 查看自己的任务安排
- 了解任务依赖关系
- 查看截止日期
- 更新任务进度

**使用频率**: 每天  
**技术水平**: 高

#### 5. 管理层
**需求**:
- 查看项目全局
- 了解关键节点
- 做出决策
- 查看多项目对比

**使用频率**: 每周  
**技术水平**: 低到中等

### 用户画像

**用户A - 项目经理 张伟**
- 年龄: 35岁
- 经验: 8年项目管理经验
- 痛点: 项目可视化不足，难以跟踪进度
- 期望: 一眼看清项目全局，快速识别风险

**用户B - 团队负责人 李娜**
- 年龄: 30岁
- 经验: 5年团队管理经验
- 痛点: 任务分配混乱，依赖关系不清晰
- 期望: 清晰的任务分配和依赖管理

**用户C - 产品经理 王强**
- 年龄: 28岁
- 经验: 3年产品经验
- 痛点: 版本规划复杂，特性交付难以追踪
- 期望: 直观的版本规划和模块视图

---

## ✨ 核心功能需求

### FR-001: 甘特图视图 (P0)

#### FR-001-1: 时间轴管理
**需求描述**: 支持多种时间刻度，精确显示项目时间线

**功能要点**:
- ✅ 支持5种时间刻度：日/周/双周/月/季度
- ✅ 自动识别周末和假期（灰色/黄色背景）
- ✅ 显示今日红线标记
- ✅ 时间轴头部显示年份和月份
- ✅ 跨年月份显示 "1月(2026)" 格式

**交互要求**:
- 点击刻度切换按钮切换视图
- 滚动查看不同时间段
- 初次加载自动定位到今日
- 视图切换保持相对位置

**验收标准**:
- ✅ 时间轴与任务元素像素级对齐
- ✅ 所有刻度切换流畅（< 100ms）
- ✅ 今日线精确对齐到当天
- ✅ 双周视图显示6个双周（12周）

#### FR-001-2: 任务管理
**需求描述**: 支持三种元素类型的创建、编辑、删除

**元素类型**:
1. **计划单元 (LinePlan)**
   - 显示为横向任务条
   - 包含起止日期
   - 显示进度百分比
   - 支持拖拽调整

2. **里程碑 (Milestone)**
   - 显示为菱形标记
   - 仅标记单个时间点
   - 支持拖拽移动

3. **关口 (Gateway)**
   - 显示为三角形标记
   - 标记决策点
   - 支持拖拽移动

**操作要求**:
- ✅ 双击时间线空白处创建元素
- ✅ 拖拽任务条调整起止日期
- ✅ 拖拽整个任务条移动时间
- ✅ 双击任务编辑详情
- ✅ 右键菜单快捷操作
- ✅ Delete键删除选中元素

**验收标准**:
- ✅ 拖拽响应延迟 < 50ms
- ✅ 拖拽时实时显示日期
- ✅ 悬停显示完整日期信息
- ✅ 支持撤销/重做（Ctrl+Z/Y）

#### FR-001-3: 依赖关系
**需求描述**: 可视化任务之间的依赖关系

**依赖类型**:
- **FS (Finish-to-Start)**: 前置任务完成后开始
- **SS (Start-to-Start)**: 与前置任务同时开始
- **FF (Finish-to-Finish)**: 与前置任务同时完成
- **SF (Start-to-Finish)**: 前置任务开始后完成

**功能要点**:
- ✅ 拖拽连接点创建依赖
- ✅ SVG线条绘制连接
- ✅ 箭头指向依赖方向
- ✅ 不同类型不同样式
- ✅ 悬停高亮显示
- ✅ 点击删除依赖

**验收标准**:
- ✅ 连线自动避让任务条
- ✅ 连线随任务移动更新
- ✅ 循环依赖提示警告
- ✅ 支持批量删除

#### FR-001-4: 基线管理
**需求描述**: 标记和对比项目基线

**基线类型**:
1. **时间点基线**: 标记特定日期（如发布日）
2. **时间范围基线**: 标记时间段（如测试期）

**功能要点**:
- ✅ 创建/编辑/删除基线
- ✅ 基线显示为垂直线或色块
- ✅ 不同颜色区分不同基线
- ✅ 基线对比显示偏差
- ✅ 基线标签显示

**验收标准**:
- ✅ 基线位置精确
- ✅ 基线颜色可配置
- ✅ 基线可拖拽调整
- ✅ 基线不影响任务编辑

---

### FR-002: 表格视图 (P0)

#### FR-002-1: 表格展示
**需求描述**: 以表格形式展示所有任务

**表格列**:
- 名称（带类型图标）
- 类型（计划单元/里程碑/关口）
- 开始日期
- 结束日期
- 时长（自动计算）
- 依赖关系（显示前置任务）
- 进度（0-100%）
- 负责人

**功能要点**:
- ✅ 表格排序（按任意列）
- ✅ 表格筛选（按类型、状态）
- ✅ 行内编辑
- ✅ 批量选择
- ✅ 导出Excel/CSV

**验收标准**:
- ✅ 支持1000+行数据
- ✅ 排序响应 < 100ms
- ✅ 编辑即时生效
- ✅ 导出格式正确

#### FR-002-2: 版本对比视图
**需求描述**: 对比不同版本的变更

**功能要点**:
- ✅ 选择两个版本对比
- ✅ 高亮显示变更
- ✅ 显示新增/删除/修改
- ✅ 显示依赖关系变化

**验收标准**:
- ✅ 变更准确标识
- ✅ 支持并排对比
- ✅ 支持差异导出

---

### FR-003: 模块规划视图 (P1)

#### FR-003-1: 模块分组
**需求描述**: 按产品线和模块分组展示

**分组层级**:
1. **一级分组**: 产品线（电子架构、感知算法、规划决策）
2. **二级分组**: 模块（E0架构、视觉感知、行为决策等）

**功能要点**:
- ✅ 折叠/展开产品线面板
- ✅ 卡片式展示MR
- ✅ 显示类型、负责人、日期、进度
- ✅ 显示模块间依赖关系
- ✅ 点击查看详情

**验收标准**:
- ✅ 分组逻辑清晰
- ✅ 卡片布局美观
- ✅ 依赖关系可视化
- ✅ 支持拖拽调整顺序

#### FR-003-2: 迭代规划
**需求描述**: 按时间迭代展示任务

**功能要点**:
- ✅ 按迭代分组
- ✅ 显示迭代时间范围
- ✅ 显示迭代进度
- ✅ 支持迭代调整

**验收标准**:
- ✅ 迭代划分清晰
- ✅ 进度计算准确
- ✅ 支持跨迭代依赖

---

### FR-004: 数据管理 (P0)

#### FR-004-1: 撤销/重做
**需求描述**: 支持所有编辑操作的撤销和重做

**功能要点**:
- ✅ 记录所有编辑操作
- ✅ 支持多级撤销（100+步）
- ✅ Ctrl+Z 撤销
- ✅ Ctrl+Y 重做
- ✅ 工具栏撤销/重做按钮

**验收标准**:
- ✅ 撤销/重做准确无误
- ✅ 状态一致性保证
- ✅ 性能无明显影响

#### FR-004-2: 数据持久化
**需求描述**: 自动保存和手动保存

**功能要点**:
- ✅ localStorage 自动保存（300ms防抖）
- ✅ 手动保存按钮
- ✅ 保存状态提示
- ✅ 数据校验

**验收标准**:
- ✅ 刷新页面数据不丢失
- ✅ 异常情况数据恢复
- ✅ 保存性能 < 100ms

#### FR-004-3: 数据导入导出
**需求描述**: 支持数据的导入和导出

**功能要点**:
- ✅ JSON格式导入导出
- ✅ Excel/CSV格式导出
- ✅ 批量导入
- ✅ 数据校验和错误提示

**验收标准**:
- ✅ 导出数据完整准确
- ✅ 导入兼容性好
- ✅ 错误提示清晰

---

### FR-005: 视图交互 (P0)

#### FR-005-1: 智能定位
**需求描述**: 自动定位到今日位置

**触发场景**:
1. 初次加载页面
2. 从其他视图返回甘特图
3. 点击"今天"按钮

**功能要点**:
- ✅ 今日位置居中显示
- ✅ 平滑滚动动画
- ✅ 今日红线高亮

**验收标准**:
- ✅ 定位准确（误差 < 1px）
- ✅ 动画流畅（60fps）
- ✅ 所有场景一致

#### FR-005-2: 滚动位置保持
**需求描述**: 视图切换时保持相对位置

**功能要点**:
- ✅ 切换前记录相对比例
- ✅ 切换后应用相同比例
- ✅ 保持时间上下文一致

**示例**:
- 月视图滚动到50%（6月）
- 切换到日视图
- 自动滚动到50%（仍在6月）

**验收标准**:
- ✅ 位置保持准确（误差 < 5%）
- ✅ 即时切换（无延迟）
- ✅ 所有刻度通用

---

## 🔧 非功能需求

### NFR-001: 性能要求 (P0)

#### 响应时间
- 首屏加载: < 2s
- 组件渲染: < 100ms
- 拖拽响应: < 50ms
- 数据保存: < 100ms
- 视图切换: < 200ms

#### 容量支持
- 支持1000+任务元素
- 支持100+时间线分组
- 支持500+依赖关系
- 支持50+基线

#### 并发支持
- 支持100+并发用户
- 支持10+同时编辑

### NFR-002: 可用性要求 (P0)

#### 易用性
- 新用户5分钟上手
- 核心操作 < 3次点击
- 快捷键覆盖常用操作
- 操作可撤销

#### 可访问性
- 支持键盘导航
- 屏幕阅读器友好
- 颜色对比度 WCAG AA

#### 兼容性
- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

### NFR-003: 可维护性 (P1)

#### 代码质量
- TypeScript 100%覆盖
- 单元测试覆盖率 > 80%
- 代码规范遵循 ESLint

#### 文档完整性
- API文档完整
- 用户手册完整
- 技术文档完整

### NFR-004: 安全性 (P1)

#### 数据安全
- 本地数据加密存储
- XSS防护
- CSRF防护

---

## 🎭 用户场景

### 场景1: 项目经理查看项目进度

**用户**: 项目经理 张伟  
**目标**: 快速了解项目整体进度和风险

**步骤**:
1. 打开项目计划
2. 自动定位到今日
3. 查看今日红线位置
4. 识别延期任务（红色）
5. 查看关键里程碑
6. 切换到表格视图查看详细信息

**预期结果**:
- 5秒内完成整体进度查看
- 清晰识别3个延期任务
- 确认2个关键里程碑未受影响

### 场景2: 团队负责人调整任务

**用户**: 团队负责人 李娜  
**目标**: 调整任务时间和依赖关系

**步骤**:
1. 打开团队时间线
2. 拖拽任务A延后3天
3. 系统自动计算依赖任务影响
4. 调整任务B的开始时间
5. 添加任务C的依赖关系
6. 保存更改

**预期结果**:
- 拖拽流畅，实时反馈
- 依赖关系自动更新
- 冲突提示清晰
- 所有更改可撤销

### 场景3: 产品经理规划版本

**用户**: 产品经理 王强  
**目标**: 规划下个版本的特性交付

**步骤**:
1. 切换到模块规划视图
2. 查看各模块的MR安排
3. 识别模块间依赖
4. 调整MR顺序
5. 添加新的里程碑
6. 导出版本计划

**预期结果**:
- 模块划分清晰
- 依赖关系可视化
- 调整操作简单
- 导出格式规范

### 场景4: 开发人员更新进度

**用户**: 开发人员 赵明  
**目标**: 更新任务进度

**步骤**:
1. 打开任务列表
2. 找到自己的任务
3. 双击编辑进度
4. 更新进度为80%
5. 添加备注
6. 保存

**预期结果**:
- 找到任务 < 10s
- 编辑界面友好
- 保存即时生效
- 团队可见更新

---

## 📊 功能优先级

### P0 - 必须有（Must Have）
- ✅ FR-001: 甘特图视图
- ✅ FR-002: 表格视图
- ✅ FR-004: 数据管理
- ✅ FR-005: 视图交互
- ✅ NFR-001: 性能要求
- ✅ NFR-002: 可用性要求

### P1 - 应该有（Should Have）
- ✅ FR-003: 模块规划视图
- ✅ NFR-003: 可维护性
- ✅ NFR-004: 安全性

### P2 - 可以有（Could Have）
- 多项目管理
- 项目模板
- 数据分析报表
- 移动端支持

### P3 - 暂不考虑（Won't Have）
- 实时协作编辑
- AI智能推荐
- 视频教程
- 插件市场

---

## ✅ 验收标准

### 功能验收

#### 甘特图视图
- [x] 支持5种时间刻度
- [x] 时间轴与任务精确对齐
- [x] 拖拽操作流畅
- [x] 依赖关系可视化
- [x] 基线管理完整

#### 表格视图
- [x] 表格排序筛选
- [x] 行内编辑
- [x] 数据导出

#### 模块规划视图
- [x] 两级分组清晰
- [x] 卡片式展示美观
- [x] 依赖关系可视化

#### 数据管理
- [x] 撤销/重做准确
- [x] 自动保存可靠
- [x] 导入导出完整

#### 视图交互
- [x] 智能定位准确
- [x] 滚动位置保持

### 性能验收
- [x] 首屏加载 < 2s
- [x] 拖拽响应 < 50ms
- [x] 视图切换 < 200ms
- [x] 支持1000+任务

### 用户体验验收
- [x] 新用户5分钟上手
- [x] 操作直观易懂
- [x] 错误提示清晰
- [x] 快捷键完整

### 兼容性验收
- [x] Chrome 90+ ✅
- [x] Firefox 88+ ✅
- [x] Safari 14+ ✅
- [x] Edge 90+ ✅

### 文档验收
- [x] 用户手册完整
- [x] 技术文档完整
- [x] API文档完整

---

## 📅 版本历史

### v0.2.0 (2026-02-09) ✅ 当前版本
**核心功能**:
- ✅ 时间轴对齐优化
- ✅ 视图交互优化
- ✅ 双周视图密度调整
- ✅ 智能定位功能

**改进**:
- 统一坐标计算系统
- 优化滚动位置保持
- 完善单元测试

### v0.1.3 (2026-02-08)
**核心功能**:
- ✅ 模块规划视图
- ✅ 表格视图增强
- ✅ 类型系统重构

### v0.1.0 (2026-01-28)
**核心功能**:
- ✅ 甘特图基础功能
- ✅ 拖拽编辑
- ✅ 依赖关系
- ✅ 基线管理

---

## 📚 相关文档

### 核心文档
- [完整方案设计](./COMPLETE-SOLUTION-DESIGN.md) - 技术架构详解
- [快速开始](./QUICK-START.md) - 5分钟上手指南
- [视图指南](./VIEW-GUIDE.md) - 各视图使用说明
- [用户指南](./V11.3-USER-GUIDE.md) - 完整使用手册

### 技术文档
- [时间轴计算分析](./TIMELINE-CALCULATION-ANALYSIS.md) - 坐标系统详解
- [迭代视图设计](./ITERATION-VIEW-DESIGN.md) - 迭代视图实现
- [模块规划指南](./MODULE-ITERATION-VIEW-GUIDE.md) - 模块视图使用

### PRD详细文档
- [PRD - 甘特图核心功能](../../prds/01-PRD-甘特图核心功能.md)
- [PRD - 迭代规划视图](../../prds/02-PRD-迭代规划视图.md)
- [PRD - 数据管理与协作](../../prds/03-PRD-数据管理与协作.md)

---

## 📞 联系方式

**项目仓库**: https://github.com/zjx-immersion/timeplan-craft-kit  
**问题反馈**: https://github.com/zjx-immersion/timeplan-craft-kit/issues  
**文档位置**: `/Users/jxzhong/workspace/voyah-devops-solution/devops-conponent-design/timeplan-craft-kit/`

---

**文档版本**: v1.0.0  
**最后更新**: 2026-02-09  
**文档状态**: ✅ 已完成  
**维护者**: 前端团队
